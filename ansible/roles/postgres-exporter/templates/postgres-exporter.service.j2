[Unit]
Description=Prometheus postgres_exporter
Documentation=https://github.com/prometheus-community/postgres_exporter
After=network-online.target
Wants=network-online.target

[Service]
User={{ postgres_exporter_user }}
Group={{ postgres_exporter_user }}
Type=simple
Environment="DATA_SOURCE_NAME={{ postgres_exporter_dsn }}"
ExecStart={{ exporter_bin_dir }}/postgres_exporter \
    --web.listen-address={{ exporter_listen_address }}:{{ postgres_exporter_port }} \
{% if postgres_exporter_custom_queries %}
    --extend.query-path={{ exporter_config_dir }}/postgres-exporter/queries.yml \
{% endif %}
    {{ postgres_exporter_extra_args }}
Restart=on-failure
RestartSec=10s
SyslogIdentifier=postgres-exporter

NoNewPrivileges=yes
ProtectSystem=strict
ProtectHome=yes
PrivateTmp=yes

[Install]
WantedBy=multi-user.target
